
// === i18n dictionary ===
const i18n = {
  en: {
    nav_about: "About", nav_adv: "Adventures", nav_gallery: "Gallery", nav_book: "Book Now",
    hero_h1_1: "Dive Into the", hero_h1_2: "Future",
    hero_sub: "Premium scuba diving • Sea trips • Private charters",
    hero_cta_primary: "Book Your Dive", hero_cta_secondary: "Explore Adventures",
    hero_pills: "Hurghada • Safaga • Marsa Alam",
    about_title: "About Shark X",
    about_p1: "At Shark X, we deliver unforgettable Red Sea experiences led by a professional, safety-first team. Our mission is simple: the customer’s best service, every time.",
    about_p2: "Based in Hurghada, we also craft special dive trips in Safaga and Marsa Alam — including wrecks like the legendary SS Thistlegorm — as well as private boat charters and island escapes.",
    about_b1: "Beginner to pro-level dive programs",
    about_b2: "Wreck, reef, night & safari dives",
    about_b3: "Custom private trips & boats",
    about_b4: "Price details & packages — on request",
    adv_title: "Our Adventures",
    card_coral_title: "Coral Reef Diving",
    card_coral_desc: "Crystal-clear sites with turtles, rays and vibrant corals — tremendous spots across Hurghada.",
    card_wreck_title: "Wreck Diving",
    card_wreck_desc: "Historic wrecks, Hurghada coast + Underwater Museum tanks — adventure guaranteed.",
    card_safari_title: "Safari & Special Dives",
    card_safari_desc: "7‑day liveaboards with elite boats • Safaga & Marsa Alam • sharks, pelagics, pristine reefs.",
    card_private_title: "Private Boats & Islands",
    card_private_desc: "Private & standard boat trips — islands, diving and snorkeling for all groups.",
    note_pricing: "All pricing & package info is shared on request — contact us to plan your trip.",
    reviews_box: "Customer Reviews",
    reviews_open: "Open Reviews",
    reviews_leave: "Leave a Review",
    form_name: "Your Name", form_rating: "Rating", form_text: "Your Review",
    form_submit: "Submit Review",
    contact_title: "Contact & Booking",
    contact_hint: "Tell us your dates, experience level, and the adventure you want. We’ll craft a perfect plan.",
    contact_email: "Email", contact_instagram: "Instagram", contact_whatsapp: "Reserve Your Dive on WhatsApp",
    footer: "© Shark X • The Sea Within Your Heart"
  },
  ru: {
    nav_about: "О нас", nav_adv: "Приключения", nav_gallery: "Галерея", nav_book: "Забронировать",
    hero_h1_1: "Погружайся в", hero_h1_2: "будущее",
    hero_sub: "Премиальные дайв-туры • Морские прогулки • Частные чартеры",
    hero_cta_primary: "Забронировать дайв", hero_cta_secondary: "Смотреть программы",
    hero_pills: "Хургада • Сафага • Марса-Алам",
    about_title: "О Shark X",
    about_p1: "Shark X дарит незабываемые впечатления от Красного моря с профессиональной и безопасной командой. Наша миссия проста: лучший сервис для клиента — всегда.",
    about_p2: "База в Хургаде, а также спец-туры в Сафаге и Марса-Аламе — включая легендарный SS Thistlegorm — плюс частные чартеры и острова.",
    about_b1: "Программы от новичка до профи",
    about_b2: "Рэки, рифы, ночные и сафари-дайвы",
    about_b3: "Индивидуальные поездки и лодки",
    about_b4: "Цены и пакеты — по запросу",
    adv_title: "Наши приключения",
    card_coral_title: "Рифовые погружения",
    card_coral_desc: "Кристально чистые локации с черепахами, скатами и яркими кораллами — топ‑споты Хургады.",
    card_wreck_title: "Погружения на затонувшие корабли",
    card_wreck_desc: "Исторические рэки у берегов Хургады + танки Подводного музея — гарантированное приключение.",
    card_safari_title: "Сафари и спец‑дайвы",
    card_safari_desc: "7‑дневные лайвэборды на элитных яхтах • Сафага и Марса‑Алам • акулы, пелагика, девственные рифы.",
    card_private_title: "Частные лодки и острова",
    card_private_desc: "Частные и обычные морские туры — острова, дайвинг и снорклинг для любых групп.",
    note_pricing: "Все цены и пакеты — по запросу. Свяжитесь с нами для планирования.",
    reviews_box: "Отзывы клиентов",
    reviews_open: "Открыть отзывы",
    reviews_leave: "Оставить отзыв",
    form_name: "Ваше имя", form_rating: "Оценка", form_text: "Ваш отзыв",
    form_submit: "Отправить",
    contact_title: "Контакты и бронирование",
    contact_hint: "Сообщите даты, опыт и желаемое приключение — мы соберём идеальный план.",
    contact_email: "Email", contact_instagram: "Instagram", contact_whatsapp: "Забронировать в WhatsApp",
    footer: "© Shark X • Море в вашем сердце"
  },
  de: {
    nav_about: "Über uns", nav_adv: "Abenteuer", nav_gallery: "Galerie", nav_book: "Jetzt buchen",
    hero_h1_1: "Tauche in die", hero_h1_2: "Zukunft",
    hero_sub: "Premium‑Tauchgänge • Bootstouren • Private Charter",
    hero_cta_primary: "Tauchgang buchen", hero_cta_secondary: "Abenteuer entdecken",
    hero_pills: "Hurghada • Safaga • Marsa Alam",
    about_title: "Über Shark X",
    about_p1: "Bei Shark X bieten wir unvergessliche Rotmeer‑Erlebnisse mit einem professionellen, sicherheitsorientierten Team. Unsere Mission: bester Service für den Kunden – jedes Mal.",
    about_p2: "Basis in Hurghada, dazu Spezialtouren in Safaga und Marsa Alam – inkl. Wracks wie der legendären SS Thistlegorm – sowie Privatboote und Inseltrips.",
    about_b1: "Programme von Einsteiger bis Profi",
    about_b2: "Wrack‑, Riff‑, Nacht‑ & Safari‑Tauchgänge",
    about_b3: "Individuelle Privattouren & Boote",
    about_b4: "Preise & Pakete – auf Anfrage",
    adv_title: "Unsere Abenteuer",
    card_coral_title: "Korallenriff‑Tauchgänge",
    card_coral_desc: "Kristallklare Plätze mit Schildkröten, Rochen und leuchtenden Korallen – Top‑Spots rund um Hurghada.",
    card_wreck_title: "Wracktauchen",
    card_wreck_desc: "Historische Wracks an der Küste Hurghadas + Unterwassermuseum‑Panzer – Abenteuer garantiert.",
    card_safari_title: "Safari & Spezialtauchgänge",
    card_safari_desc: "7‑tägige Liveaboards auf exklusiven Yachten • Safaga & Marsa Alam • Haie, Pelagik, unberührte Riffe.",
    card_private_title: "Private Boote & Inseln",
    card_private_desc: "Private & normale Bootstouren – Inseln, Tauchen und Schnorcheln für alle Gruppen.",
    note_pricing: "Alle Preise & Pakete auf Anfrage – kontaktieren Sie uns zur Planung.",
    reviews_box: "Kundenbewertungen",
    reviews_open: "Bewertungen öffnen",
    reviews_leave: "Bewertung abgeben",
    form_name: "Ihr Name", form_rating: "Bewertung", form_text: "Ihre Bewertung",
    form_submit: "Bewertung senden",
    contact_title: "Kontakt & Buchung",
    contact_hint: "Teilen Sie Daten, Erfahrungsniveau und Wunsch‑Abenteuer – wir erstellen den perfekten Plan.",
    contact_email: "E‑Mail", contact_instagram: "Instagram", contact_whatsapp: "Auf WhatsApp buchen",
    footer: "© Shark X • Das Meer in deinem Herzen"
  }
};

// language state
const $ = sel => document.querySelector(sel);
const $$ = sel => Array.from(document.querySelectorAll(sel));
const langBtns = $$(".flagbtn");
function setLang(code){
  localStorage.setItem("sx_lang", code);
  langBtns.forEach(b=>b.classList.toggle("active", b.dataset.lang===code));
  // translate
  $$("[data-i18n]").forEach(el=>{
    const key = el.dataset.i18n;
    if(i18n[code] && i18n[code][key]) el.textContent = i18n[code][key];
  });
  document.documentElement.lang = code;
  renderReviews();
}
langBtns.forEach(b=>b.addEventListener("click", ()=>setLang(b.dataset.lang)));
setLang(localStorage.getItem("sx_lang") || "en");

// Hero CTA anchors (no-op in this demo)
$("#cta-adv")?.addEventListener("click", ()=>{
  $("#adventures")?.scrollIntoView({behavior:"smooth"});
});

// Card thumbs (images)
const thumbs = {
  coral: "images/coral_turtle.jpeg",
  wreck: "images/wreck_ship.jpeg",
  safari: "images/safari_shark.jpeg",
  private: "images/island_pier.jpeg"
};
$("#thumb-coral").style.backgroundImage = `url(${thumbs.coral})`;
$("#thumb-wreck").style.backgroundImage = `url(${thumbs.wreck})`;
$("#thumb-safari").style.backgroundImage = `url(${thumbs.safari})`;
$("#thumb-private").style.backgroundImage = `url(${thumbs.private})`;

// Reviews data + local additions via localStorage
const seedReviews = [
  {name:"Ahmed S.", text:"Best dive week of my life — dolphins, pristine reefs, and a super safe team.", stars:5},
  {name:"Katrin M.", text:"Professional guides and creative routes. We saw turtles, rays and an epic wreck.", stars:5},
  {name:"Omar H.", text:"Private boat day was flawless. Islands + snorkel for the kids = perfect.", stars:5},
  {name:"Lena K.", text:"Safari trip delivered sharks and zero stress. Meals, cabins, everything 10/10.", stars:5}
];

function getStored(){
  try{
    return JSON.parse(localStorage.getItem("sx_user_reviews")||"[]");
  }catch(e){return []}
}
function saveStored(list){
  localStorage.setItem("sx_user_reviews", JSON.stringify(list));
}

function allReviews(){
  return [...seedReviews, ...getStored()];
}

// Reviews rendering
function renderReviews(){
  const lang = document.documentElement.lang || "en";
  const list = allReviews();
  const grid = $("#rev-grid");
  const header = $("#rev-title");
  const count = list.length;
  $("#rev-count").textContent = `(${count})`;
  const titleMap = {en:"Customer Reviews", ru:"Отзывы клиентов", de:"Kundenbewertungen"};
  header.textContent = `${titleMap[lang]||titleMap.en} (${count})`;
  grid.innerHTML = list.map(r=>`
    <div class="rev">
      <b>${r.name}</b>
      <div class="stars">${"★".repeat(r.stars)}${"☆".repeat(5-r.stars)}</div>
      <div>${r.text}</div>
    </div>
  `).join("");
}
renderReviews();

// Open/close modal
const modal = $("#rev-modal");
$("#open-reviews")?.addEventListener("click", ()=>{
  renderReviews();
  modal.classList.add("open");
});
$("#rev-close")?.addEventListener("click", ()=>modal.classList.remove("open"));
modal.addEventListener("click", (e)=>{ if(e.target===modal) modal.classList.remove("open") });

// Handle review form
$("#rev-form")?.addEventListener("submit", (e)=>{
  e.preventDefault();
  const name = $("#rev-name").value.trim();
  const text = $("#rev-text").value.trim();
  const stars = parseInt($("#rev-stars").value || "5", 10);
  if(!name || !text) return;
  const stored = getStored();
  stored.push({name,text,stars});
  saveStored(stored);
  $("#rev-name").value = ""; $("#rev-text").value = ""; $("#rev-stars").value="5";
  renderReviews();
});
